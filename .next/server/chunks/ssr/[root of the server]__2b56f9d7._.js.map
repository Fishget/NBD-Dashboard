{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 183, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/sheets.ts"],"sourcesContent":["'use server';\n\nimport { google } from 'googleapis';\nimport type { sheets_v4 } from 'googleapis';\nimport type { SheetRow } from './types'; // Import SheetRow from the new types.ts\n\n// Environment variables\nconst SHEET_ID = process.env.GOOGLE_SHEET_ID;\nconst SERVICE_ACCOUNT_EMAIL = process.env.GOOGLE_SERVICE_ACCOUNT_EMAIL;\nconst RAW_PRIVATE_KEY_FROM_ENV = process.env.GOOGLE_PRIVATE_KEY;\nconst SHEET_RANGE = process.env.GOOGLE_SHEET_RANGE || 'Sheet1!A:E'; // Default range if not specified\n\nfunction processPrivateKey(rawKeyInput: string | undefined): string | null {\n  if (typeof rawKeyInput !== 'string' || rawKeyInput.trim() === '') {\n    console.error('[SheetLib:PK_Process] CRITICAL: GOOGLE_PRIVATE_KEY environment variable is undefined, empty, or only whitespace. This is a required credential.');\n    return null;\n  }\n\n  let key = rawKeyInput.trim();\n\n  if (key.startsWith('{') && key.endsWith('}')) {\n    try {\n      const parsedJson = JSON.parse(key);\n      if (typeof parsedJson.private_key === 'string' && parsedJson.private_key.trim() !== '') {\n        console.warn('[SheetLib:PK_Process] Detected and extracted \"private_key\" field from what appears to be a full JSON object pasted into GOOGLE_PRIVATE_KEY. Using extracted key.');\n        key = parsedJson.private_key.trim();\n      } else if (parsedJson.private_key && typeof parsedJson.private_key !== 'string') {\n        console.error('[SheetLib:PK_Process] ERROR: Input looks like JSON, but \"private_key\" field is not a string. This will likely lead to auth failure. Proceeding with original input for further checks.');\n      } else if (!parsedJson.private_key) {\n         console.error('[SheetLib:PK_Process] ERROR: Input looks like JSON, but \"private_key\" field is missing. This will likely lead to auth failure. Proceeding with original input for further checks.');\n      }\n    } catch (e) {\n      // Not valid JSON. This is fine if the key itself happens to start/end with {}.\n      // console.log('[SheetLib:PK_Process] Input started/ended with {} but was not valid JSON or \"private_key\" was problematic. Processing as raw key string.');\n    }\n  }\n  \n  if ((key.startsWith('\"') && key.endsWith('\"')) || (key.startsWith(\"'\") && key.endsWith(\"'\"))) {\n    key = key.substring(1, key.length - 1);\n  }\n\n  key = key.replace(/\\\\\\\\r\\\\\\\\n/g, '\\r\\n').replace(/\\\\\\\\n/g, '\\n');\n  key = key.replace(/\\r\\n/g, '\\n').replace(/\\r/g, '\\n');\n\n\n  if (!key.startsWith('-----BEGIN PRIVATE KEY-----')) {\n    console.error('[SheetLib:PK_Process] ERROR: Processed GOOGLE_PRIVATE_KEY does NOT START with \"-----BEGIN PRIVATE KEY-----\". Key is malformed or incomplete. Ensure the entire key, including this header, is correctly copied.');\n    return null;\n  }\n  if (!key.endsWith('-----END PRIVATE KEY-----')) {\n    console.error('[SheetLib:PK_Process] ERROR: Processed GOOGLE_PRIVATE_KEY does NOT END with \"-----END PRIVATE KEY-----\". Key is malformed or incomplete. Ensure the entire key, including this footer, is correctly copied.');\n    return null;\n  }\n  if (!key.includes('\\n')) {\n    console.error('[SheetLib:PK_Process] ERROR: Processed GOOGLE_PRIVATE_KEY does NOT contain any newline characters. PEM private keys are multi-line. Ensure newlines were preserved or correctly represented (e.g., as actual newlines or literal \\\\n in the .env string that get unescaped).');\n    return null;\n  }\n  \n  const coreKeyContent = key\n    .substring('-----BEGIN PRIVATE KEY-----'.length, key.length - '-----END PRIVATE KEY-----'.length)\n    .trim();\n\n  if (coreKeyContent.length === 0) {\n    console.error('[SheetLib:PK_Process] ERROR: Processed GOOGLE_PRIVATE_KEY has PEM markers but NO content in between. This key is invalid.');\n    return null;\n  }\n  \n  // console.log('[SheetLib:PK_Process] SUCCESS: GOOGLE_PRIVATE_KEY appears structurally valid after processing.');\n  return key;\n}\n\nexport async function getSheetsClient(): Promise<sheets_v4.Sheets | null> {\n  const errorParts: string[] = [];\n  if (!SHEET_ID) errorParts.push('CRITICAL: GOOGLE_SHEET_ID environment variable is not set.');\n  if (!SERVICE_ACCOUNT_EMAIL) errorParts.push('CRITICAL: GOOGLE_SERVICE_ACCOUNT_EMAIL environment variable is not set.');\n\n  const processedPrivateKey = processPrivateKey(RAW_PRIVATE_KEY_FROM_ENV);\n\n  if (!processedPrivateKey) {\n    // processPrivateKey already logged specific details.\n    errorParts.push('CRITICAL: GOOGLE_PRIVATE_KEY is missing, empty, or critically malformed after processing. Check server logs above for \"[SheetLib:PK_Process]\" for specific details on the private key issue. Authentication will fail.');\n  }\n\n  if (errorParts.length > 0) {\n    const fullMessage = '[SheetLib:getSheetsClient] CRITICAL: Cannot initialize Google Sheets client due to missing or invalid core credentials:\\n- ' + errorParts.join('\\n- ');\n    console.error(fullMessage);\n    return null;\n  }\n\n  try {\n    // console.log('[SheetLib:getSheetsClient] Attempting to create GoogleAuth client with processed credentials...');\n    const auth = new google.auth.GoogleAuth({\n      credentials: {\n        client_email: SERVICE_ACCOUNT_EMAIL!, \n        private_key: processedPrivateKey!, \n      },\n      scopes: ['https://www.googleapis.com/auth/spreadsheets'],\n    });\n    // console.log('[SheetLib:getSheetsClient] GoogleAuth client instance created successfully.');\n    return google.sheets({ version: 'v4', auth });\n  } catch (error: any) {\n    console.error('[SheetLib:getSheetsClient] CRITICAL: Error during GoogleAuth instantiation (the step before calling google.sheets API):');\n    console.error('Error Name:', error.name);\n    console.error('Error Message:', error.message);\n    if (error.stack) console.error('Error Stack (partial):', error.stack.substring(0, 500));\n\n    if (error.message?.includes('DECODER routines') || error.message?.includes('PEM routines') || error.message?.includes('private key') || error.message?.includes('asn1 encoding')) {\n      console.error(\n        '[SheetLib:getSheetsClient] Auth Init Error Detail: This error (' + error.message + ') STRONGLY indicates an issue with the PROCESSED_PRIVATE_KEY format or value. ' +\n        'The key might have passed initial structural checks by `processPrivateKey` but is still not parsable by the underlying crypto library. ' +\n        'Verify the original key source and ensure it is correctly copied into the GOOGLE_PRIVATE_KEY environment variable. Double-check for hidden characters or incorrect newline representations if copying from complex sources.'\n      );\n    }\n    return null;\n  }\n}\n\n\nexport async function getSheetData(): Promise<SheetRow[] | null> {\n  let sheets: sheets_v4.Sheets | null = null;\n  try {\n      sheets = await getSheetsClient();\n  } catch (clientError: any) {\n      // This catch is for truly unexpected errors *within* getSheetsClient itself,\n      // though getSheetsClient is designed to return null for known config/auth issues.\n      console.error('[SheetLib:getSheetData] CRITICAL: Unexpected fatal error from getSheetsClient() call itself:', clientError.message);\n      if (clientError.stack) console.error(clientError.stack);\n      return null; // Signifies critical config/init error\n  }\n\n  if (!sheets) {\n     // getSheetsClient returning null means a configuration issue was detected and logged by it.\n     console.error('[SheetLib:getSheetData] Google Sheets client is null (client initialization failed due to credential/config issues detailed above). Cannot fetch data. Returning null to indicate configuration error.');\n     return null; // Signifies critical config/init error\n  }\n\n  if (!SHEET_ID){ // Should have been caught by getSheetsClient, but as a safeguard for direct calls.\n    console.error('[SheetLib:getSheetData] ConfigurationError: GOOGLE_SHEET_ID is not configured on the server. Cannot fetch data. Returning null.');\n    return null;\n  }\n  if (!SHEET_RANGE){\n    // Default is used if not set, so this might be less critical unless default is also bad.\n    console.warn('[SheetLib:getSheetData] Warning: GOOGLE_SHEET_RANGE is not configured on the server. Using default: ' + SHEET_RANGE); \n  }\n\n  try {\n    // console.log(`[SheetLib:getSheetData] Fetching data from SHEET_ID: ${SHEET_ID}, RANGE: ${SHEET_RANGE}`);\n    const response = await sheets.spreadsheets.values.get({\n      spreadsheetId: SHEET_ID,\n      range: SHEET_RANGE,\n    });\n\n    const rows = response.data.values;\n    if (!rows || rows.length === 0) {\n      // console.log('[SheetLib:getSheetData] No data found in the specified sheet range or sheet is empty. Returning empty array.');\n      return []; // Success, but no data\n    }\n\n    const headers = rows[0].map(header => String(header).trim());\n    const dataRows = rows.slice(1);\n\n    const expectedHeaders = ['Donor/Opp', 'Action/Next Step', 'Lead', 'Priority', 'Probability'];\n    const missingHeaders = expectedHeaders.filter(eh => !headers.includes(eh));\n    if (missingHeaders.length > 0) {\n       console.warn(`[SheetLib:getSheetData] Sheet is missing expected headers: [${missingHeaders.join(', ')}]. Current headers: [${headers.join(', ')}]. Data mapping might be incorrect or incomplete.`);\n    }\n\n    const mappedData = dataRows.map((rowArray: any[]) => {\n      const rowData: Partial<SheetRow> = {};\n      headers.forEach((header, index) => {\n        const cellValue = rowArray[index] !== undefined && rowArray[index] !== null ? String(rowArray[index]) : '';\n        const key = header as keyof SheetRow; \n\n        if (expectedHeaders.includes(header)) { \n            if ((key === 'Priority' || key === 'Probability')) {\n               const value = cellValue.trim();\n               if (['High', 'Medium', 'Low'].includes(value)) {\n                  rowData[key] = value as 'High' | 'Medium' | 'Low';\n               } else {\n                  rowData[key] = 'Medium'; \n               }\n            } else {\n               rowData[key] = cellValue;\n            }\n        }\n      });\n      expectedHeaders.forEach(eh => {\n        const key = eh as keyof SheetRow;\n        if (!(key in rowData)) {\n          if (key === 'Priority' || key === 'Probability') {\n            rowData[key] = 'Medium'; \n          } else {\n            rowData[key] = ''; \n          }\n        }\n      });\n      return rowData as SheetRow;\n    }).filter(row => { \n      const opp = row['Donor/Opp']?.trim();\n      const action = row['Action/Next Step']?.trim();\n      const lead = row.Lead?.trim();\n      return !!(opp || action || lead);\n    });\n    return mappedData;\n\n  } catch (error: any) {\n    console.error('[SheetLib:getSheetData] CRITICAL ERROR during sheets.spreadsheets.values.get API call:');\n    \n    let details = 'Unknown API error during data fetch.';\n    if (error.message) {\n      details = error.message;\n    }\n    \n    // Check for common Google API error structures\n    if (error.response?.data?.error?.message) {\n        details = `Google API Error: ${error.response.data.error.message} (Status: ${error.response.data.error.code})`;\n    } else if (error.errors && Array.isArray(error.errors) && error.errors.length > 0) {\n        details = `Google API Error: ${error.errors[0].message} (Reason: ${error.errors[0].reason})`;\n    } else if (error.code) { // e.g., Node.js system errors like ENOTFOUND\n        details = `System Error Code: ${error.code}, Message: ${error.message}`;\n    }\n\n    let specificHint = details; // Start with the most specific detail we found\n\n    const gErrorCode = error.response?.data?.error?.code || (typeof error.code === 'number' ? error.code : null);\n\n\n    if (details.includes('PERMISSION_DENIED') || gErrorCode === 403) {\n        specificHint = `Permission Denied. Ensure the service account (${SERVICE_ACCOUNT_EMAIL || 'SERVICE_ACCOUNT_EMAIL_not_set_in_env'}) has at least 'Viewer' access to the Google Sheet (ID: ${SHEET_ID || 'SHEET_ID_not_set_in_env'}). You need to share the sheet with the service account email.`;\n    } else if (details.includes('Requested entity was not found') || gErrorCode === 404) {\n        specificHint = `Sheet Not Found. Verify that the GOOGLE_SHEET_ID ('${SHEET_ID || 'SHEET_ID_not_set_in_env'}') is correct and the sheet exists. Also check if the GOOGLE_SHEET_RANGE ('${SHEET_RANGE || 'Using default range'}') is valid for this sheet (e.g., the sheet name in the range exists).`;\n    } else if (details.includes('INVALID_ARGUMENT') || details.includes('Unable to parse range') || gErrorCode === 400) {\n        specificHint = `Invalid Argument or Range. The GOOGLE_SHEET_RANGE ('${SHEET_RANGE || 'Using default range'}') is likely invalid or does not exist in the sheet. Ensure it's in 'SheetName!A1:E' format. The error might also indicate a malformed Sheet ID.`;\n    } else if (details.includes('UNAUTHENTICATED') || gErrorCode === 401) {\n        specificHint = `Authentication Failed. The service account credentials may be invalid or expired. This is less likely if client initialization succeeded but could indicate a permissions revocation or token issue. Check the validity of your service account key.`;\n    } else if (details.includes('ENOTFOUND') || details.includes('EAI_AGAIN')) {\n        specificHint = `Network Error: Could not resolve hostname (e.g., www.googleapis.com). Check server's internet connectivity and DNS resolution. Error: ${error.message}`;\n    } else if (gErrorCode === 500 || gErrorCode === 503) {\n        specificHint = `Google API Server Error (Status: ${gErrorCode}). This is likely a temporary issue on Google's side. Try again later. Error: ${details}`;\n    }\n\n\n    console.error(`[SheetLib:getSheetData] Full Error Object Structure (if available from Google API):`, JSON.stringify(error.response?.data || error.errors || error, null, 2));\n    console.error(`[SheetLib:getSheetData] Processed Error Details from API call: ${details}`);\n    console.error(`[SheetLib:getSheetData] Specific User Hint for API call failure: ${specificHint}. Returning empty array to prevent UI crash, but data fetch failed.`);\n    return []; // API call failed, return empty array. Config was likely okay if client initialized.\n  }\n}\n\nexport async function appendSheetRow(rowData: Omit<SheetRow, ''>): Promise<boolean> {\n  let sheets: sheets_v4.Sheets | null = null;\n  try {\n      sheets = await getSheetsClient();\n  } catch (clientError: any) {\n      console.error('[SheetLib:appendSheetRow] Error obtaining Google Sheets client in appendSheetRow:', clientError.message);\n      return false; \n  }\n\n   if (!sheets) {\n      console.error(\"[SheetLib:appendSheetRow] Google Sheets client not available for appendSheetRow (client initialization failed due to credential/config issues detailed above). Cannot append data.\");\n      return false; \n   }\n   if (!SHEET_ID) { \n    console.error(\"[SheetLib:appendSheetRow] ConfigurationError: GOOGLE_SHEET_ID is not configured for appendSheetRow.\");\n    return false;\n   }\n   if (!SHEET_RANGE) { \n    console.error(\"[SheetLib:appendSheetRow] ConfigurationError: GOOGLE_SHEET_RANGE is not configured for appendSheetRow (though it has a default).\");\n    // Allow continuation if default is used, but log.\n   }\n\n\n  const values = [\n    rowData['Donor/Opp'],\n    rowData['Action/Next Step'],\n    rowData.Lead,\n    rowData.Priority,\n    rowData.Probability\n  ];\n\n  try {\n    await sheets.spreadsheets.values.append({\n      spreadsheetId: SHEET_ID,\n      range: SHEET_RANGE, \n      valueInputOption: 'USER_ENTERED',\n      insertDataOption: 'INSERT_ROWS',\n      requestBody: {\n        values: [values],\n      },\n    });\n    // console.log('[SheetLib:appendSheetRow] Row appended successfully to Google Sheet.');\n    return true;\n  } catch (error: any) {\n    console.error('[SheetLib:appendSheetRow] Error appending sheet row via Google Sheets API:');\n     let details = 'Unknown API error during data append.';\n    if (error.message) {\n      details = error.message;\n    }\n     if (error.response?.data?.error?.message) {\n        details = `Google API Error: ${error.response.data.error.message} (Status: ${error.response.data.error.code})`;\n    } else if (error.errors && Array.isArray(error.errors) && error.errors.length > 0) {\n        details = `Google API Error: ${error.errors[0].message} (Reason: ${error.errors[0].reason})`;\n    }\n    console.error(`[SheetLib:appendSheetRow] Full Error Object:`, JSON.stringify(error.response?.data || error.errors || error, null, 2));\n    console.error(`[SheetLib:appendSheetRow] Processed Error Details: ${details}`);\n    return false;\n  }\n}\n\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 482, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 545, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/dashboard-table.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const DashboardTable = registerClientReference(\n    function() { throw new Error(\"Attempted to call DashboardTable() from the server but DashboardTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/dashboard-table.tsx <module evaluation>\",\n    \"DashboardTable\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,iBAAiB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAChD;IAAa,MAAM,IAAI,MAAM;AAA4O,GACzQ,oEACA","debugId":null}},
    {"offset": {"line": 559, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/dashboard-table.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const DashboardTable = registerClientReference(\n    function() { throw new Error(\"Attempted to call DashboardTable() from the server but DashboardTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/dashboard-table.tsx\",\n    \"DashboardTable\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,iBAAiB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAChD;IAAa,MAAM,IAAI,MAAM;AAA4O,GACzQ,gDACA","debugId":null}},
    {"offset": {"line": 573, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 583, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/skeleton.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n"],"names":[],"mappings":";;;;AAAA;;;AAEA,SAAS,SAAS,EAChB,SAAS,EACT,GAAG,OACkC;IACrC,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,qCAAqC;QAClD,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 607, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG1B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,4DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGrC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QAAI,KAAK;QAAK,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 688, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/page.tsx"],"sourcesContent":["\nimport { Suspense } from 'react';\nimport type { SheetRow } from '../lib/types';\nimport { getSheetData } from '@/lib/sheets';\nimport { DashboardTable } from '@/components/dashboard-table';\nimport { Skeleton } from '@/components/ui/skeleton';\nimport { InfoIcon, ServerCrash, AlertTriangle } from 'lucide-react';\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from '@/components/ui/card';\n\n// Helper component for loading skeleton\nfunction TableSkeleton() {\n  return (\n    <div className=\"space-y-4\">\n       <div className=\"flex justify-end\">\n            <Skeleton className=\"h-10 w-[250px]\" />\n       </div>\n      <div className=\"rounded-md border\">\n        <div className=\"overflow-auto\">\n          <table className=\"w-full caption-bottom text-sm\">\n            <thead className=\"[&_tr]:border-b\">\n              <tr className=\"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\">\n                <th className=\"h-12 px-4 text-left align-middle font-medium text-muted-foreground\"><Skeleton className=\"h-4 w-[150px]\" /></th>\n                <th className=\"h-12 px-4 text-left align-middle font-medium text-muted-foreground\"><Skeleton className=\"h-4 w-[200px]\" /></th>\n                <th className=\"h-12 px-4 text-left align-middle font-medium text-muted-foreground\"><Skeleton className=\"h-4 w-[100px]\" /></th>\n                <th className=\"h-12 px-4 text-left align-middle font-medium text-muted-foreground\"><Skeleton className=\"h-4 w-[80px]\" /></th>\n                <th className=\"h-12 px-4 text-left align-middle font-medium text-muted-foreground\"><Skeleton className=\"h-4 w-[100px]\" /></th>\n              </tr>\n            </thead>\n            <tbody className=\"[&_tr:last-child]:border-0\">\n              {[...Array(5)].map((_, i) => (\n                <tr key={i} className=\"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\">\n                  <td className=\"p-4 align-middle\"><Skeleton className=\"h-4 w-full\" /></td>\n                  <td className=\"p-4 align-middle\"><Skeleton className=\"h-4 w-full\" /></td>\n                  <td className=\"p-4 align-middle\"><Skeleton className=\"h-4 w-full\" /></td>\n                  <td className=\"p-4 align-middle\"><Skeleton className=\"h-4 w-full\" /></td>\n                  <td className=\"p-4 align-middle\"><Skeleton className=\"h-4 w-full\" /></td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// DashboardData is a Server Component to fetch data\nasync function DashboardData() {\n  let tableData: SheetRow[] = []; // Default to empty array\n  let errorOccurred = false; // General API or unexpected error\n  let isConfigError = false; // Specific flag for configuration errors\n  // Changed the default success message to \"Live Data\"\n  let userFriendlyMessage = \"Live Data\";\n\n  try {\n    // console.log(\"[Page:DashboardData SC] Attempting to fetch data.\");\n    const dataResult = await getSheetData(); // Can be SheetRow[] or null\n\n    if (dataResult === null) {\n      isConfigError = true;\n      // This message is critical. Server logs from [SheetLib:] will have the specifics.\n      userFriendlyMessage = \"CRITICAL CONFIGURATION ERROR: Could not connect to Google Sheets. Please ensure GOOGLE_SHEET_ID, GOOGLE_SERVICE_ACCOUNT_EMAIL, and a valid GOOGLE_PRIVATE_KEY are correctly set in your environment variables and the server has been restarted. Check server logs for '[SheetLib:]' messages for details.\";\n      tableData = []; // Ensure tableData is an array for DashboardTable\n    } else {\n      tableData = Array.isArray(dataResult) ? dataResult : [];\n      if (tableData.length === 0) {\n        // This case means API call was successful, but no data rows returned.\n        // Or, an API error occurred after client init, and getSheetData returned [].\n        userFriendlyMessage = \"No data available in the Google Sheet, or the sheet is empty. If this is unexpected, please verify the sheet contents and the API configuration (Sheet ID, Range, Permissions) in the admin panel or server logs if an API error was logged by [SheetLib:getSheetData].\";\n        // We don't set errorOccurred = true here unless we know an API error happened.\n        // Checking server logs is important if this state is unexpected.\n      }\n      // If tableData has items, userFriendlyMessage remains \"Live Data\"\n    }\n  } catch (error: any) { // Catch any other unexpected throws (should be rare with new getSheetData)\n    console.error(\"[Page:DashboardData SC] Unexpected error during data fetching:\", error);\n    errorOccurred = true; // Mark as a general error\n    userFriendlyMessage = `An unexpected error occurred while fetching data: ${error.message || 'Unknown error'}. Please check server logs.`;\n    tableData = []; // Ensure tableData is an array\n  }\n\n  const isSuccessWithData = !isConfigError && !errorOccurred && tableData.length > 0;\n\n  return (\n    <Card className=\"my-8 shadow-md\">\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2 text-primary\">\n          <InfoIcon className=\"h-6 w-6\" />\n          Dashboard View\n        </CardTitle>\n         <CardDescription className={isSuccessWithData ? \"text-primary\" : \"\"}>\n          {userFriendlyMessage}\n        </CardDescription>\n      </CardHeader>\n      <CardContent>\n        {isConfigError && (\n             <div className=\"my-4 p-4 border border-destructive/50 rounded-md bg-destructive/10\">\n                <div className=\"flex items-center gap-3 text-destructive\">\n                    <AlertTriangle className=\"h-8 w-8\" />\n                    <div>\n                        <p className=\"font-semibold\">Configuration Error</p>\n                        <p className=\"text-sm\">\n                           {userFriendlyMessage} {/* Display the detailed config error message */}\n                        </p>\n                    </div>\n                </div>\n            </div>\n        )}\n        {errorOccurred && !isConfigError && ( // General error, not config related\n             <div className=\"my-4 p-4 border border-destructive/20 rounded-md bg-destructive/10\">\n                <div className=\"flex items-center gap-3 text-destructive\">\n                    <ServerCrash className=\"h-8 w-8\" />\n                    <div>\n                        <p className=\"font-semibold\">Error Fetching Data</p>\n                        <p className=\"text-sm\">\n                            {userFriendlyMessage} {/* Display the general error message */}\n                        </p>\n                    </div>\n                </div>\n            </div>\n        )}\n        {/* Display message if no config error, no general error, but data is empty */}\n        {tableData.length === 0 && !isConfigError && !errorOccurred && (\n             <div className=\"my-4 p-4 border border-dashed border-border rounded-md bg-muted/50\">\n                <div className=\"flex items-center gap-3 text-muted-foreground\">\n                    <InfoIcon className=\"h-8 w-8 text-blue-500\" />\n                    <div>\n                        <p className=\"font-semibold text-card-foreground\">No Data to Display</p>\n                        <p className=\"text-sm\">\n                           {userFriendlyMessage}\n                        </p>\n                    </div>\n                </div>\n            </div>\n        )}\n         <div className=\"mt-6\">\n            {/* DashboardTable expects initialData to be SheetRow[] */}\n            <DashboardTable initialData={tableData} />\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nexport default function Home() {\n  // console.log(\"[Page:Home SC] Rendering Home page.\");\n  return (\n    <div className=\"space-y-6\">\n      <h1 className=\"text-3xl font-bold text-primary\">NBD Dashboard</h1>\n      <p className=\"text-muted-foreground\">\n        Live Data\n      </p>\n      <Suspense fallback={<TableSkeleton />}>\n        <DashboardData />\n      </Suspense>\n    </div>\n  );\n}\n\nexport const dynamic = 'force-dynamic';\n"],"names":[],"mappings":"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","debugId":null}}]
}